<template>
  <div class='home'>
    <h1>PokéViewer</h1>
    <form v-on:submit.prevent='onSubmit'>
      <label>
      View Pokémon:<br>
      <input v-model='name' type='text' list='all-pokemon-list' placeholder='Pikachu'>
      <div class='matches' v-if='list.length && name.length'>
        <div class='match' v-for='match in matches'>
          <router-link :to='"/pokemon/" + match'>
            {{match}}
          </router-link>
        </div>
      </div>
    </form>
  </div>
</template>

<style scoped>
  .home, .home input[type='text'] {
    text-align: center;
  }
  .match {
    margin-top: 0.5em;
  }
  .matches {
    margin-top: 1em;
  }
</style>

<script>
import PageTitle from '../mixins/PageTitle';
import dex from '../pokedex';
import router from '../router';
import * as lazy from 'lazy.js';

export default {
  name: 'home',
  mixins: [PageTitle],
  data() {
    return {
      name: '',
      title: '',
      list: [],
    };
  },
  computed: {
    matches() {
      const result = lazy(this.list)
        .pluck('name')
        .filter(name => name.includes(this.name.toLowerCase()))
        .take(20)
        .toArray();
      window.result = result;
      return result;
    },
  },
  created() {
    dex.getPokemonsList().then(res => {
      this.list = res.results;
    });
  },
  methods: {
    onSubmit() {
      router.push(`/pokemon/${this.name}`);
    },
  },
};
</script>